
--EJERCICIO4
-- EJERCICIO ALVARO

create or replace procedure ejercicio4julio(x number) is

  cursor cequipos is
    select * from asociacion;

  cursor centrenador is
    select * from entrenador;

    numEquipos number;
    numEntrenadores number;
    no_asociacion exception;

begin 
  for creg in cequipos loop
    select count(*) into numEquipos from equipo where creg.codigo = equipo.asociacion;
    select count(*) into numEntrenadores from entrenador where creg.codigo = entrenador.asociacion;

    if numEquipos >= x then
      if numEntrenadores = 0 then
        --insert into desiertas (codigo,nombre,total) values (creg.codigo,creg.nombre,numEquipo);
        escribir('"INSERTANDO" ***** en desiertas asociacion: '|| creg.codigo || ' ' || creg.nombre || ' ' || numEntrenadores ||'*****');
      else
        escribir('ASOCIACION: *****' || creg.codigo || ' ' || creg.nombre || ' ' || numEntrenadores ||'*****');
          for creg2 in centrenador loop
            escribir(creg2.nif|| ' ' || creg2.nombre);
          end loop;
        end if;
    else
      raise no_asociacion;
    end if;
  end loop;
     exception 
        when no_asociacion then
          escribir('No hay asociaciones con ' || x || ' o mas equipos');
end;